<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Editar Curso - {{ curso.nome }}</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    /* Paleta de cores */
    :root {
      --azul-escuro: #0d1f3c;
      --azul-claro: #1e3a8a;
      --amarelo: #ffc107;
      --branco: #ffffff;
      --cinza-claro: #f8f9fa;
      --cinza-medio: #e9ecef;
      --cinza-escuro: #6b7280;
      --verde: #198754;
      --vermelho: #dc3545;
    }

    body {
      background-color: var(--cinza-claro);
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      align-items: center;
      padding: 40px 20px;
      color: var(--azul-escuro);
    }

    header {
      width: 100%;
      background-color: var(--azul-escuro);
      color: var(--amarelo);
      text-align: center;
      padding: 15px 0;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      margin-bottom: 40px;
    }

    .card {
      background-color: var(--branco);
      border-radius: 12px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      padding: 30px;
      max-width: 800px;
      width: 100%;
      margin-bottom: 20px;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.16);
    }

    h2 {
      text-align: center;
      margin-bottom: 30px;
      font-weight: 600;
      color: var(--azul-escuro);
    }

    .form-label {
      font-weight: 500;
      color: var(--azul-escuro);
    }

    .form-control, .form-select {
      border-radius: 8px;
      border: 1px solid var(--cinza-medio);
      padding: 10px;
      transition: all 0.2s;
    }

    .form-control:focus, .form-select:focus {
      border-color: var(--azul-claro);
      box-shadow: 0 0 0 2px rgba(30,58,138,0.2);
      outline: none;
    }

    .btn {
      padding: 10px 18px;
      border-radius: 8px;
      font-weight: 500;
      transition: all 0.2s;
      border: none;
      cursor: pointer;
    }

    .btn-success {
      background-color: var(--verde);
      color: var(--branco);
    }

    .btn-success:hover {
      background-color: #117a33;
    }

    .btn-secondary {
      background-color: var(--cinza-medio);
      color: var(--azul-escuro);
      margin-left: 10px;
    }

    .btn-secondary:hover {
      background-color: #d6d6d6;
    }

    .add-materia {
      margin-top: 15px;
    }

    .row.g-2 > .col-md-4,
    .row.g-2 > .col-md-2,
    .row.g-2 > .col-md-4 select {
      margin-bottom: 10px;
    }

    @media (max-width: 576px) {
      .card {
        padding: 20px;
      }
    }
  </style>
</head>
<body>
  <header>
    <h6>INTEC - Editar Curso: {{ curso.nome }}</h6>
  </header>

  <form method="POST" style="width: 100%; max-width: 800px;">
    {% for periodo, materias in curso.materias.items() %}
    <div class="card">
      <div class="card-header" style="font-weight: 600; font-size: 1.1rem;">Período {{ periodo }}</div>
      <div class="card-body" id="periodo_{{ periodo }}">
        {% for m in materias %}
        <div class="row g-2 mb-2 materia-item">
          <div class="col-md-4">
            <input type="text" name="materias_{{ periodo }}[]" class="form-control" value="{{ m.nome }}" placeholder="Matéria">
          </div>
          <div class="col-md-2">
            <input type="number" name="aulas_{{ periodo }}[]" class="form-control" value="{{ m.aulas }}" placeholder="Qtd. aulas">
          </div>
          <div class="col-md-4">
            <select name="professores_{{ periodo }}[]" class="form-select">
              <option value="">Escolher professor</option>
              {% for u in professores %}
              <option value="{{ u.email }}" {% if m.professor == u.email %}selected{% endif %}>{{ u.fullname }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-md-2">
            <input type="text" class="form-control" placeholder="Gerado automaticamente" readonly>
          </div>
        </div>
        {% endfor %}

        <div class="row g-2 mb-2 materia-item d-none template" id="template_{{ periodo }}">
          <div class="col-md-4">
            <input type="text" name="materias_{{ periodo }}[]" class="form-control" placeholder="Nova matéria...">
          </div>
          <div class="col-md-2">
            <input type="number" name="aulas_{{ periodo }}[]" class="form-control" placeholder="Qtd. aulas">
          </div>
          <div class="col-md-4">
            <select name="professores_{{ periodo }}[]" class="form-select">
              <option value="">Escolher professor</option>
              {% for u in professores %}
              <option value="{{ u.email }}">{{ u.fullname }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-md-2">
            <input type="text" class="form-control" placeholder="Gerado automaticamente" readonly>
          </div>
        </div>

        <button type="button" class="btn btn-secondary btn-sm add-materia" data-periodo="{{ periodo }}">+ Adicionar Matéria</button>
      </div>
    </div>
    {% endfor %}

    <div class="d-flex justify-content-center mt-3">
      <button type="submit" class="btn btn-success">Salvar Alterações</button>
      <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Voltar</a>
    </div>
  </form>

  <script>
    document.querySelectorAll('.add-materia').forEach(btn => {
      btn.addEventListener('click', () => {
        const periodo = btn.getAttribute('data-periodo');
        const container = document.getElementById(`periodo_${periodo}`);
        const template = document.getElementById(`template_${periodo}`);
        const newRow = template.cloneNode(true);
        newRow.classList.remove('d-none');
        newRow.classList.remove('template');
        container.insertBefore(newRow, btn);
      });
    });
  </script>
</body>
</html>